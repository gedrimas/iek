<!DOCTYPE html>
<html>
<head>
    <title>Breackers</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-progressbar/0.9.0/bootstrap-progressbar.min.js"></script>

</head>
<body  class="container text-center">

<h3>Поиск по характеристикам</h3>

<div>
    <ul class="nav nav-tabs nav-justified">
        <li class="active"><a data-target="#iekTab" data-toggle="tab">IEK</a></li>
        <li><a data-target="#abbTab" data-toggle="tab">ABB</a></li>
    </ul>

    <div class="tab-content">
        <div class="tab-pane active" id="iekTab">
            <form id="price">
                <input type="hidden" name="id" value="0" />
                <div class="form-group">
                    <div class="moduleBreakers">
                        <label class="radio-inline"><input type="radio" name="moduleBreakers" value="47-29">Авт. выключатель ВА47-29</label>
                        <label class="radio-inline"><input type="radio" name="moduleBreakers" value="47-29М">Авт. выключатель ВА47-29М</label><br>
                        <label class="radio-inline"><input type="radio" name="moduleBreakers" value="47-60">Авт. выключатель ВА47-60</label>
                        <label class="radio-inline"><input type="radio" name="moduleBreakers" value="47-100">Авт. выключатель ВА47-100</label>
                    </div><br>

                    <div class="current">
                        <label class="radio-inline"><input type="radio" name="current" value="1">1 ампер</label>
                        <label class="radio-inline"><input type="radio" name="current" value="2">2 ампера</label>
                        <label class="radio-inline"><input type="radio" name="current" value="3">3 ампера</label>
                        <label class="radio-inline"><input type="radio" name="current" value="4">4 ампера</label>
                        <label class="radio-inline"><input type="radio" name="current" value="5">5 ампер</label><br>
                        <label class="radio-inline"><input type="radio" name="current" value="6">6 ампер</label>
                        <label class="radio-inline"><input type="radio" name="current" value="8">8 ампер</label>
                        <label class="radio-inline"><input type="radio" name="current" value="10">10 ампер</label>
                        <label class="radio-inline"><input type="radio" name="current" value="13">13 ампер</label>
                        <label class="radio-inline"><input type="radio" name="current" value="16">16 ампер</label>
                        <label class="radio-inline"><input type="radio" name="current" value="20">20 ампер</label><br>
                        <label class="radio-inline"><input type="radio" name="current" value="25">25 ампер</label>
                        <label class="radio-inline"><input type="radio" name="current" value="32">32 ампера</label>
                        <label class="radio-inline"><input type="radio" name="current" value="40">40 ампер</label>
                        <label class="radio-inline"><input type="radio" name="current" value="50">50 ампер</label>
                        <label class="radio-inline"><input type="radio" name="current" value="63">63 ампера</label>
                        <label class="radio-inline"><input type="radio" name="current" value="80">80 ампер</label>
                        <label class="radio-inline"><input type="radio" name="current" value="100">100 ампер</label>
                    </div><br>
                    <div class="pole">
                        <label class="radio-inline"><input type="radio" name="pole" value="1">1 полюс</label>
                        <label class="radio-inline"><input type="radio" name="pole" value="2">2 полюса</label>
                        <label class="radio-inline"><input type="radio" name="pole" value="3">3 полюса</label>
                        <label class="radio-inline"><input type="radio" name="pole" value="4">4 полюса</label>
                    </div><br>
                    <div class="feature">
                        <label class="radio-inline"><input type="radio" name="feature" value="В">характеристика В</label>
                        <label class="radio-inline"><input type="radio" name="feature" value="С">характеристика С</label>
                        <label class="radio-inline"><input type="radio" name="feature" value="D">характеристика D</label>
                    </div>
                </div>
                <div class="btn-group btn-group-justified" style="padding: 0 20% 5% 20%">
                    <div class="btn-group">
                        <button type="submit" class="btn btn-sm btn-info">
                            <span class="glyphicon glyphicon-search"></span>  Найти</button>
                    </div>
                    <div class="btn-group">
                        <a class="btn btn-sm btn-danger">
                            <span class="glyphicon glyphicon-remove"></span>  Очистить</a>
                    </div>
                </div>

            </form>
        </div>

        <div class="tab-pane fade" id="abbTab">
            <form id="abb">
                <input type="hidden" name="id" value="0" />
                <div class="form-group">
                    <div class="moduleBreakers">
                        <label class="radio-inline"><input type="radio" name="moduleBreakers" value="47-29">Авт. выключатель S200</label>
                        <label class="radio-inline"><input type="radio" name="moduleBreakers" value="47-29М">Авт. выключатель S200</label><br>
                        <label class="radio-inline"><input type="radio" name="moduleBreakers" value="47-60">Авт. выключатель S200</label>
                        <label class="radio-inline"><input type="radio" name="moduleBreakers" value="47-100">Авт. выключатель S200</label>
                    </div><br>

                    <div class="current">
                        <label class="radio-inline"><input type="radio" name="current" value="1">1 ампер</label>
                        <label class="radio-inline"><input type="radio" name="current" value="2">2 ампера</label>
                        <label class="radio-inline"><input type="radio" name="current" value="3">3 ампера</label>
                        <label class="radio-inline"><input type="radio" name="current" value="4">4 ампера</label>
                        <label class="radio-inline"><input type="radio" name="current" value="5">5 ампер</label><br>
                        <label class="radio-inline"><input type="radio" name="current" value="6">6 ампер</label>
                        <label class="radio-inline"><input type="radio" name="current" value="8">8 ампер</label>
                        <label class="radio-inline"><input type="radio" name="current" value="10">10 ампер</label>
                        <label class="radio-inline"><input type="radio" name="current" value="13">13 ампер</label>
                        <label class="radio-inline"><input type="radio" name="current" value="16">16 ампер</label>
                        <label class="radio-inline"><input type="radio" name="current" value="20">20 ампер</label><br>
                        <label class="radio-inline"><input type="radio" name="current" value="25">25 ампер</label>
                        <label class="radio-inline"><input type="radio" name="current" value="32">32 ампера</label>
                        <label class="radio-inline"><input type="radio" name="current" value="40">40 ампер</label>
                        <label class="radio-inline"><input type="radio" name="current" value="50">50 ампер</label>
                        <label class="radio-inline"><input type="radio" name="current" value="63">63 ампера</label>
                    </div><br>
                    <div class="pole">
                        <label class="radio-inline"><input type="radio" name="pole" value="1">1 полюс</label>
                        <label class="radio-inline"><input type="radio" name="pole" value="2">2 полюса</label>
                        <label class="radio-inline"><input type="radio" name="pole" value="3">3 полюса</label>
                        <label class="radio-inline"><input type="radio" name="pole" value="4">4 полюса</label>
                    </div><br>
                    <div class="feature">
                        <label class="radio-inline"><input type="radio" name="feature" value="B">характеристика В</label>
                        <label class="radio-inline"><input type="radio" name="feature" value="C">характеристика С</label>
                        <label class="radio-inline"><input type="radio" name="feature" value="D">характеристика D</label>
                    </div>
                </div>
                <div class="btn-group btn-group-justified" style="padding: 0 20% 5% 20%">
                    <div class="btn-group">
                        <button type="submit" class="btn btn-sm btn-info">
                            <span class="glyphicon glyphicon-search"></span>  Найти</button>
                    </div>
                    <div class="btn-group">
                        <a class="btn btn-sm btn-danger">
                            <span class="glyphicon glyphicon-remove"></span>  Очистить</a>
                    </div>
                </div>

            </form>
        </div>
    </div>
</div>

<div style="height: 20px">
    <div class="progress progress-striped active" style="height: 5px; display: none" id="progressBar">
        <div class="progress-bar progress-bar-info" role="progressbar" data-transitiongoal="100"></div>
    </div>
</div>

<table class="table table-condensed table-striped">
    <thead><tr><th class="text-center">Артикул</th><th class="text-center">Наименование</th><th class="text-center">Стоимость</th></tr></thead>
    <tbody>
    </tbody>
</table>
<script>

    function progressBar() {
        $('.progress .progress-bar').progressbar();
        $('#progressBar').toggle();
    }


    function CreateUser(moduleBreakers, current, pole, feature, formID) {
        $.ajax({
            url: "feature",
            contentType: "application/json",
            method: "POST",
            data: JSON.stringify({
                cur: current,
                pol: pole,
                fe: feature,
                form: formID,
                modulebraker: moduleBreakers
            }),
            success: function (itm) {

                if(itm.length == 0){
                    message();
                }

                $('#progressBar').toggle();

                var rows = "";
                $.each(itm, function(indexs, itms){
                    rows += row(itms);
                });
                $("table tbody").append(rows);
            }
        })
    }

    function message(){
        var wornMessage = [];
        $("form").find('input').each(function(index, elem) {
            if(this.checked){
                wornMessage += elem.parentElement.textContent + "\n";
            }
        });
        wornMessage += 'ДАННАЯ КОНФИГУРАЦИЯ ОТСУТСТВУЕТ В ЛИНЕЙКЕ ПРОИЗВОДИТЕЛЯ.\nИЗМЕНИТЕ КРИТЕРИИ ОТБОРА.'
        alert(wornMessage);
    }


    $("form").submit(function (e) {
        e.preventDefault();
        var formID = this.getAttribute('id');
        var current = this.elements["current"].value;
        var pole = this.elements["pole"].value;
        var feature = this.elements["feature"].value;
        var moduleBreaker = this.elements["moduleBreakers"].value;
        CreateUser(moduleBreaker, current, pole, feature, formID);

        progressBar();

    });

    $("form a").on("click", function(){
        reset();
        cleartable();
    });

    function reset() {
        var forms = document.getElementsByTagName('form');
        for(var i = 0; i < forms.length; i++) {
            forms[i].reset();
        }
    }

    function cleartable(){
        var tbody = document.querySelector('tbody');
        while(tbody.firstChild){
            tbody.removeChild(tbody.firstChild);
        }
    }

    var row = function (itm) {
        return "<tr> <td>" + itm.art + "</td>" +
            "<td>" + itm.name + "</td> <td>" + itm.cost + "</td> </tr>";
    }

</script>
</body>
</html>
